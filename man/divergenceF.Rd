% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/divergence.R
\name{divergenceF}
\alias{divergenceF}
\title{Divergence calculation for degrees of freedom}
\usage{
divergenceF(X, Y, Q, W, b_PC, b_FC, lam)
}
\arguments{
\item{X}{the \eqn{n \times p} design matrix}

\item{Y}{the response vector}

\item{Q}{the compression matris}

\item{W}{for faster computation, \eqn{W = X (X'Q'QX + lam I)^{-1} X'}}

\item{b_PC}{the coefficient vector estimated via partial compression}

\item{b_FC}{the coefficient vector estimated via full compression}

\item{lam}{the tuning parameter}
}
\value{
A list with two components: \code{divergence} gives the estimated
degrees of freedom, \code{partial_F.partial.y} gives the gradient with respect
to the response \code{Y}.
}
\description{
For approximating the degrees of freedom of the convex combination of full
and partial compression.
}
\details{
\deqn{W = X( t(X)t(Q)QX + lam I)^(-1)t(X)}
\deqn{\hat{Y} = F(y) = W f(y) g(y) h(y)}
\deqn{\Rightarrow F_i(y) = W[i,] f(y) g(y) h(y)}
\deqn{\partial F_i(y) / \partial y_i = W[i,] (df gh + f(dg h + g dh))}
}
